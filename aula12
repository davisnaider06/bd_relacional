SELECT
    r.nome AS reservatorio,

    -- Subconsulta 1: Calcula a média do pH para o reservatório atual (r)
    (SELECT AVG(s.valor)
     FROM series_temporais s
     INNER JOIN parametro p ON s.id_parametro = p.id_parametro
     WHERE s.id_reservatorio = r.id_reservatorio
       AND p.nome = 'pH'
    ) AS media_ph,

    -- Subconsulta 2: Calcula o valor mínimo do pH para o reservatório atual (r)
    (SELECT MIN(s.valor)
     FROM series_temporais s
     INNER JOIN parametro p ON s.id_parametro = p.id_parametro
     WHERE s.id_reservatorio = r.id_reservatorio
       AND p.nome = 'pH'
    ) AS ph_minimo,

    -- Subconsulta 3: Calcula o valor máximo do pH para o reservatório atual (r)
    (SELECT MAX(s.valor)
     FROM series_temporais s
     INNER JOIN parametro p ON s.id_parametro = p.id_parametro
     WHERE s.id_reservatorio = r.id_reservatorio
       AND p.nome = 'pH'
    ) AS ph_maximo

a
FROM reservatorio r
ORDER BY r.nome; -- Ordena o resultado final pelo nome do reservatório
